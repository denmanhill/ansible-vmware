---
- hosts: ESXiHosts[0]
  connection: local
  tasks:
  - name: Gather cluster facts from given datacenter
    vmware_cluster_facts:
      hostname: "{{ vmvcenter }}"
      username: "{{ VCC_USERNAME }}"
      password: "{{ VCC_PASSWORD }}"
      datacenter: "{{ vmdatacenter }}"
      validate_certs: false
    register: cluster_facts_json

  - debug:
      msg: "{{ cluster_facts_json.clusters | list }}"
  - name: Get foo value.
    set_fact:
      clusters_value: "{{ cluster_facts_json.clusters | list }}"

  - name: Gather cluster facts from given datacenter
    vmware_resource_pool_facts:
      hostname: "{{ vmvcenter }}"
      username: "{{ VCC_USERNAME }}"
      password: "{{ VCC_PASSWORD }}"
      validate_certs: false
    register: rp_facts
